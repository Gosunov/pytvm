from pytvm.tvm_emulator.tvm_emulator import TvmEmulator
from pytoniq_core import Cell, begin_cell


"""GET WALLET SEQNO"""


# take contract's code and data
code = Cell.one_from_boc('b5ee9c72410214010002d4000114ff00f4a413f4bcf2c80b010201200203020148040504f8f28308d71820d31fd31fd31f02f823bbf264ed44d0d31fd31fd3fff404d15143baf2a15151baf2a205f901541064f910f2a3f80024a4c8cb1f5240cb1f5230cbff5210f400c9ed54f80f01d30721c0009f6c519320d74a96d307d402fb00e830e021c001e30021c002e30001c0039130e30d03a4c8cb1f12cb1fcbff1011121302e6d001d0d3032171b0925f04e022d749c120925f04e002d31f218210706c7567bd22821064737472bdb0925f05e003fa403020fa4401c8ca07cbffc9d0ed44d0810140d721f404305c810108f40a6fa131b3925f07e005d33fc8258210706c7567ba923830e30d03821064737472ba925f06e30d06070201200809007801fa00f40430f8276f2230500aa121bef2e0508210706c7567831eb17080185004cb0526cf1658fa0219f400cb6917cb1f5260cb3f20c98040fb0006008a5004810108f45930ed44d0810140d720c801cf16f400c9ed540172b08e23821064737472831eb17080185005cb055003cf1623fa0213cb6acb1fcb3fc98040fb00925f03e20201200a0b0059bd242b6f6a2684080a06b90fa0218470d4080847a4937d29910ce6903e9ff9837812801b7810148987159f31840201580c0d0011b8c97ed44d0d70b1f8003db29dfb513420405035c87d010c00b23281f2fff274006040423d029be84c600201200e0f0019adce76a26840206b90eb85ffc00019af1df6a26840106b90eb858fc0006ed207fa00d4d422f90005c8ca0715cbffc9d077748018c8cb05cb0222cf165005fa0214cb6b12ccccc973fb00c84014810108f451f2a7020070810108d718fa00d33fc8542047810108f451f2a782106e6f746570748018c8cb05cb025006cf165004fa0214cb6a12cb1fcb3fc973fb0002006c810108d718fa00d33f305224810108f459f2a782106473747270748018c8cb05cb025005cf165003fa0213cb6acb1f12cb3fc973fb00000af400c9ed54696225e5')
data = Cell.one_from_boc('b5ee9c7201010101002b0000510000004629a9a31722f1d146dcc2a181f593205cfdcc7f1b845c15947dfe7ee1a9152175f096f89440')

# create emulator
emulator = TvmEmulator(code, data, verbosity_level=0)

# run get_method
result = emulator.run_get_method(method='seqno', stack=[])

# result is list with int, Cell, Slice, Builder or None elements
print(result['stack'])  # [70]


"""GET JETTON WALLET ADDRESS"""

code = Cell.one_from_boc('te6cckECFgEABIwAART/APSkE/S88sgLAQIBYgIDAgLLBAUCAWoQEQS30IMcAkl8D4AHQ0wMBcbCSXwPg+kD6QDH6ADFx1yH6ADH6ADBzqbQAItMf0z9Z7UTQ+gDU1NHbPFB4Xwcq+kQpwBXjAlsnghB73ZfeuuMCMDFsIjcCghAsdrlzuoGBwgJAgEgDg8AXIBP+DMgbpUwgLH4M94gbvLSmtDTBzHT/9P/9ATTB9Qw0PoA+gD6APoA+gD6ADAB5jM4OTk5OQPA/1Fnuhaw8uGTAvpA+CdvEFAFoQT6APoA0XDIghAXjUUZWAcCyx/LPyL6AnDIywHJ0M8Wf1AJdMjLAhLKB8v/ydAYzxZQB/oCE8sAyVRGRPAcAqBmA8hQA/oCzMzJ7VSCEMBmDM/IWPoCyXAKAf4xNTU2OAP6APpAMPgoJnBUIBNUFAPIUAT6AljPFgHPFszJIsjLARL0APQAywDJcAH5AHTIywISygfL/8nQUAbHBfLhlFAkoVRgZMhQA/oCzMzJ7VTIUATPFhTMyfgnbxBYociAEAHLBVADf3RQA8sCEsoHy/9Y+gJxActqzMlwCwEQ4wJfB4QP8vAMAEiDB3GADMjLA8sBywgTy/8ClXFYy2HMmHBYy2EB0M8W4slw+wAAZPsAghDAdwzPyFj6AslwgwdxgAzIywPLAcsIE8v/ApVxWMthzJhwWMthAdDPFuLJcPsAAfxQNaAVvPLgSwP6QNMA0ZXIIc8WyZFt4siAGAHLBVADzxZw+gJwActqghDRc1QAWAQCyx/LPyL6RDDAAI42+ChDBHBUIBNUFAPIUAT6AljPFgHPFszJIsjLARL0APQAywDJcAH5AHTIywISygfL/8nQEs8WlmwicAHLAeL0AMkNAAiAQPsAAGe7kODeARwuoodSGEGEEyVMryVMYcQq3xgDSEmAACXMZmZFOEVKpEDfAgOWDgVKBcjYQ5OhAJm58FCIBuCoQCaoKAeQoAn0BLGeLAOeLZmSRZGWAiXoAegBlgGSQOAD8gDpkZYEJZQPl/+ToZEAMAOWCgOeLKAH9ATuA5bWJZmZkuH2AQIBWBITACm0aP2omh9AGpqaJgY6GmP6c/pg+jAAfa289qJofQBqami2EPwUALgqEAmqCgHkKAJ9ASxniwDni2ZkkWRlgIl6AHoAZYBkuAD8gDpkZYEJZQPl/+ToQAHhrxb2omh9AGpqaLaBaGmP6c/pg+i9eAqBPXgKgMAIeArkRoOtDo6ODmdF5exOTSyM7KXOje3Fze5M5e6N7WytxfBniyxni0WZeYPEZ4sA54sQRalzU5t7dGeLZOgAxaFzg3M8Z4tk6AC4ZGWDgOeLZMAUAcSC8HDl17aimzkvhQdv4Vyi8gU8VsIzhyjE4zyejdse6CfMWAWDB/QXA3DIywcBzxbJgvBhBdbMdq9AAyXpTViM5RG+W/27c7Q33FHspDkX16Q+PVgEgwf0FwJwyMsHAc8WyRUAcILw7oD9Lx4DSA4igjY1lu51LXuyf1B3a5UIagJ5GJZ1kj5YA4MH9BdwyMsH9ADJf3DIywHJ0EADB9MHlg==')
data = Cell.one_from_boc('te6cckECFQEAA6sAAg1gJPDKR8jIAQIAMgAAAAHawX+VjS7lI6IgYgaZRZfBPYMexwYBFP8A9KQT9LzyyAsDAgFiBAUCAssGBwAboPYF2omh9AH0gfSBqaMCAc4ICQIBWAwNAvcIMcAkl8E4AHQ0wMBcbCVE18D8B3g+kD6QDH6ADFx1yH6ADH6ADBzqbQAAtMfAds8WzI0NDQkghAPin6lupowbCI2XjEQI/Aa4CSCEBeNRRm6mzBsIl4yECRDAPAb4DdbNoIQWV8HvLqfAnGw8tLAUCO68uLGAfAc4F8FgCgsAET6RDDAAPLhTYABcgE/4MyBulTCAsfgz3iBu8tKa0NMHMdP/0//0BNMH1DDQ+gD6APoA+gD6APoAMAAIhA/y8AIBWA4PAgFIExQB9wF0z8BAfoA+kAh8AHtRND6APpA+kDU0VE2oVIsxwXy4sEqwv/y4sJUNEJwVCATVBQDyFAE+gJYzxYBzxbMySLIywES9AD0AMsAySBwAfkAdMjLAhLKB8v/ydAE+kD0BDH6ACDXScIA8uLEyIAYAcsFUAfPFnD6AncBy2uAQAvM7UTQ+gD6QPpA1NEK0z8BAfoAUVGgBfpA+kBTXccFVHNvcFQgE1QUA8hQBPoCWM8WAc8WzMkiyMsBEvQA9ADLAMlwAfkAdMjLAhLKB8v/ydBQD8cFHrHy4sMM+gBRyqEptggZoVAHoBihJpJsVeMNJdcLAcMAIcIAsIBESAKoTzMiCEBeNRRlYCgLLH8s/UAf6AiLPFlAGzxYl+gJQA88WyVAFzCORcpFx4lAHqBOgCKoAUASgF6AUvPLixQHJgED7AEMAyFAE+gJYzxYBzxbMye1UAHJSaaAYociCEHNi0JwpAssfyz9QB/oCUATPFlAHzxbJyIAQAcsFJ88WUAT6AnEBy2oTzMlx+wBQQhMAdI4jyIAQAcsFUAbPFlAF+gJwActqghDVMnbbWAUCyx/LP8ly+wCSWzPiQAPIUAT6AljPFgHPFszJ7VQA6ztRND6APpA+kDU0QXTPwEB+gAhwgDy4sL6QPQEAdDTn9EB0VFioVJYxwXy4sEmwv/y4sLIghB73ZfeWAQCyx/LPwH6AiPPFgHPFhPLn8nIgBgBywUjzxZw+gJxActqzMmAQPsAQBPIUAT6AljPFgHPFszJ7VSAAhyAINch7UTQ+gD6QPpA1NEE0x8BhA8hghAXjUUZugKCEHvdl966ErHy9NM/ATD6ADAToFAjyFAE+gJYzxYBzxbMye1UgKNnUPA==')

# serialize user wallet address to Slice
stack = [begin_cell().store_address('UQCPCZU37-aComPLgaQBcOkevn4x5GJHSfZsFt6eF9DpHZH9').to_slice()]

emulator = TvmEmulator(code, data, verbosity_level=0)
result = emulator.run_get_method(method='get_wallet_address', stack=stack)

print(result['stack'])  # [<Slice 267[8013AB3E25B0B2EA3C5879FFFBFF9790004AD6B6243F8B350B3073D786CF5773AE00] -> 0 refs>]

cs = result['stack'][0]  # get slice with address from result
print(cs.load_address())  # get address from slice
